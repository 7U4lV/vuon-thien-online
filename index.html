<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>V∆∞·ªùn Thi·ªÅn Online</title>
<meta name="description" content="·ª®ng d·ª•ng thi·ªÅn ƒëa ng∆∞·ªùi d√πng v·ªõi avatar ho·∫°t h√¨nh, chat v√† voice">
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üßò</text></svg>">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font:12px Arial,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);height:100vh;overflow:hidden}
.app{display:flex;height:100vh}
.garden{flex:1;position:relative;background:linear-gradient(to bottom,#87CEEB 0%,#98FB98 20%,#90EE90 40%,#32CD32 60%,#228B22 80%,#006400 100%);overflow:hidden}
.avatar{position:absolute;width:48px;height:64px;cursor:pointer;transition:all .3s;z-index:10}
.avatar.standing .s{width:48px;height:64px;background:radial-gradient(circle at 24px 16px,#FDBCB4 12px,transparent 12px),radial-gradient(circle at 24px 12px,#8B4513 14px,transparent 14px),radial-gradient(circle at 20px 16px,#000 2px,transparent 2px),radial-gradient(circle at 28px 16px,#000 2px,transparent 2px),linear-gradient(to bottom,#4169E1 20px,#4169E1 45px,transparent 45px) 12px 20px/24px 25px no-repeat,linear-gradient(to bottom,#FDBCB4 0,#FDBCB4 20px) 6px 25px/8px 20px no-repeat,linear-gradient(to bottom,#FDBCB4 0,#FDBCB4 20px) 34px 25px/8px 20px no-repeat,linear-gradient(to bottom,#000080 0,#000080 20px) 16px 45px/6px 20px no-repeat,linear-gradient(to bottom,#000080 0,#000080 20px) 26px 45px/6px 20px no-repeat}
.avatar.sitting .s{width:48px;height:50px;background:radial-gradient(circle at 24px 16px,#FDBCB4 12px,transparent 12px),radial-gradient(circle at 24px 12px,#8B4513 14px,transparent 14px),linear-gradient(to right,#000 0,#000 8px) 18px 16px/8px 1px no-repeat,linear-gradient(to bottom,#4169E1 20px,#4169E1 35px,transparent 35px) 12px 20px/24px 15px no-repeat,ellipse(12px 8px) at 18px 42px,#000080,ellipse(12px 8px) at 30px 42px,#000080}
.avatar.walking{animation:walk .8s infinite}
@keyframes walk{0%,100%{transform:translateY(0)}50%{transform:translateY(-3px)}}
.avatar.meditating{animation:glow 2s ease-in-out infinite alternate}
@keyframes glow{0%{filter:brightness(.9)}100%{filter:brightness(1.3) drop-shadow(0 0 8px gold)}}
.avatar.raising-hand::after{content:'‚úã';position:absolute;top:-25px;left:50%;transform:translateX(-50%);font-size:20px;animation:wave .5s infinite alternate}
@keyframes wave{0%{transform:translateX(-50%) rotate(-10deg)}100%{transform:translateX(-50%) rotate(10deg)}}
.avatar.speaking{border:2px solid #28a745;border-radius:50%;animation:speak-pulse 1s infinite}
@keyframes speak-pulse{0%,100%{border-color:#28a745}50%{border-color:#20c997}}
.avatar.muted{opacity:.5;filter:grayscale(50%)}
.name{position:absolute;bottom:-16px;left:50%;transform:translateX(-50%);background:rgba(255,255,255,.9);padding:1px 6px;border-radius:8px;font-size:9px;font-weight:bold;white-space:nowrap}
.name.host{background:#FFD700;color:#000}
.sidebar{width:300px;background:rgba(255,255,255,.96);display:flex;flex-direction:column;border-left:1px solid rgba(255,255,255,.3)}
.controls{padding:15px;border-bottom:1px solid #eee}
.btn-group{display:flex;gap:6px;margin:8px 0}
.btn{padding:8px 12px;border:none;border-radius:15px;cursor:pointer;font-size:11px;font-weight:bold;transition:all .3s;flex:1;text-align:center}
.btn-primary{background:#667eea;color:white}
.btn-primary:hover{background:#5a6fd8;transform:translateY(-1px)}
.btn.active{background:#28a745}
.btn-warning{background:#ffc107;color:#000}
.btn-danger{background:#dc3545;color:white}
.btn:disabled{background:#ccc;cursor:not-allowed;transform:none}
.chat{flex:1;display:flex;flex-direction:column}
.messages{flex:1;padding:10px;overflow-y:auto;max-height:220px;background:#f8f9fa}
.message{margin:6px 0;padding:6px 10px;border-radius:12px;max-width:90%;word-wrap:break-word;font-size:11px}
.message.own{background:#667eea;color:white;margin-left:auto;text-align:right}
.message.other{background:white;border:1px solid #ddd}
.message.system{background:#e9ecef;color:#495057;font-style:italic;text-align:center;margin:4px auto;font-size:10px}
.input-area{padding:10px;border-top:1px solid #eee;display:flex;gap:6px}
.input-area input{flex:1;padding:8px;border:1px solid #ddd;border-radius:15px;outline:none;font-size:11px}
.voice-controls{padding:10px;border-top:1px solid #eee;text-align:center}
.voice-status{margin-bottom:10px;font-size:11px;color:#666}
.voice-buttons{display:flex;gap:6px;justify-content:center;margin-bottom:8px}
.voice-btn{width:40px;height:40px;border:none;border-radius:50%;cursor:pointer;font-size:16px;transition:all .3s;display:flex;align-items:center;justify-content:center}
.voice-btn.mic{background:#dc3545;color:white}
.voice-btn.mic.active{background:#28a745;animation:pulse 1.5s infinite}
.voice-btn.hand{background:#ffc107;color:#000}
.voice-btn.hand.active{background:#fd7e14;animation:bounce .6s infinite}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-3px)}}
.host-controls{border-top:1px solid #eee;padding:10px;background:#f8f9fa}
.host-label{font-size:10px;color:#666;margin-bottom:8px;text-align:center}
.timer{position:absolute;top:15px;left:15px;background:rgba(255,255,255,.9);padding:12px;border-radius:12px;text-align:center;min-width:110px}
.timer-display{font:bold 20px monospace;color:#667eea;margin-bottom:8px}
.online{position:absolute;top:15px;right:15px;background:rgba(255,255,255,.9);padding:12px;border-radius:12px;min-width:160px}
.room-status{position:absolute;top:80px;right:15px;background:rgba(255,255,255,.9);padding:8px 12px;border-radius:12px;font-size:11px}
.room-status.muted{background:rgba(220,53,69,.1);border:1px solid #dc3545;color:#dc3545}
.tree{position:absolute;z-index:1;width:30px;height:65px}
.tree::before{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:6px;height:35px;background:#8B4513;border-radius:3px}
.tree::after{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:30px;height:30px;background:radial-gradient(circle,#32CD32,#228B22);border-radius:50%}
.pond{position:absolute;width:80px;height:50px;background:radial-gradient(ellipse,#4169E1,#191970);border-radius:50%;bottom:80px;right:120px;animation:ripple 4s infinite}
@keyframes ripple{0%,100%{transform:scale(1)}50%{transform:scale(1.01)}}
.flower{position:absolute;width:8px;height:8px;background:#FF69B4;border-radius:50%;z-index:1}
.flower::after{content:'';position:absolute;width:2px;height:6px;background:#32CD32;bottom:-6px;left:3px}
.username{width:100%;padding:6px;border:1px solid #ddd;border-radius:12px;margin-bottom:10px;text-align:center;font-size:11px}
.label{font-weight:bold;margin:8px 0 4px;color:#555;font-size:11px}
@media (max-width:768px){.sidebar{width:280px}.avatar{width:40px;height:52px}.timer,.online{position:relative;top:auto;left:auto;right:auto;margin:10px;display:inline-block}}
</style>
</head>
<body>
<div class="app">
<div class="garden" id="garden">
<div class="tree" style="top:90px;left:180px"></div>
<div class="tree" style="top:160px;left:320px"></div>
<div class="tree" style="top:120px;right:180px"></div>
<div class="flower" style="top:140px;left:200px"></div>
<div class="flower" style="top:200px;left:250px"></div>
<div class="flower" style="top:180px;right:200px"></div>
<div class="pond"></div>
<div class="timer">
<div class="timer-display" id="timer">00:00</div>
<button class="btn btn-primary" onclick="startTimer()">Start</button>
<button class="btn btn-primary" onclick="resetTimer()">Reset</button>
</div>
<div class="online">
<div style="font-weight:bold;color:#667eea;margin-bottom:6px">üå∏ Online: <span id="count">5</span></div>
<div style="font-size:10px;line-height:1.3" id="userList">B·∫°n (Host)<br>üå∏ Minh An<br>üçÉ Thu H√†<br>üå∫ ƒê·ª©c Nam<br>üåø Linh Chi</div>
</div>
<div class="room-status" id="roomStatus">üîä Ph√≤ng ƒëang m·ªü</div>
</div>
<div class="sidebar">
<div class="controls">
<h3 style="margin-bottom:10px;color:#667eea;font-size:14px">üßò‚Äç‚ôÄÔ∏è V∆∞·ªùn Thi·ªÅn</h3>
<input type="text" id="username" class="username" placeholder="Nh·∫≠p t√™n..." value="Thi·ªÅn sinh m·ªõi">
<div class="label">T∆∞ th·∫ø:</div>
<div class="btn-group">
<button class="btn btn-primary active" onclick="changeState('standing')">ƒê·ª©ng</button>
<button class="btn btn-primary" onclick="changeState('sitting')">Ng·ªìi</button>
</div>
<div class="label">Thi·ªÅn:</div>
<button class="btn btn-primary" id="meditateBtn" onclick="toggleMeditate()">B·∫Øt ƒë·∫ßu thi·ªÅn</button>
</div>
<div class="chat">
<div class="messages" id="messages">
<div class="message system">üå∏ Ch√†o m·ª´ng ƒë·∫øn v∆∞·ªùn thi·ªÅn! B·∫°n l√† ch·ªß ph√≤ng v√† c√≥ quy·ªÅn qu·∫£n l√Ω voice chat.</div>
</div>
<div class="input-area">
<input type="text" id="messageInput" placeholder="Tin nh·∫Øn..." onkeypress="if(event.key==='Enter')sendMessage()">
<button class="btn btn-primary" onclick="sendMessage()">G·ª≠i</button>
</div>
</div>
<div class="voice-controls">
<div class="voice-status" id="voiceStatus">üé§ Voice Chat: ƒêang m·ªü</div>
<div class="voice-buttons">
<button class="voice-btn mic" id="micBtn" onclick="toggleMic()" title="B·∫≠t/t·∫Øt mic">üé§</button>
<button class="voice-btn hand" id="handBtn" onclick="toggleHand()" title="Gi∆° tay xin ph√°t bi·ªÉu">‚úã</button>
</div>
<div style="font-size:9px;color:#666;margin-top:5px">Click mic ƒë·ªÉ n√≥i, gi∆° tay ƒë·ªÉ xin ph√°t bi·ªÉu</div>
</div>
<div class="host-controls" id="hostControls">
<div class="host-label">üëë Quy·ªÅn ch·ªß ph√≤ng:</div>
<div class="btn-group">
<button class="btn btn-warning" id="muteRoomBtn" onclick="toggleMuteRoom()">üîá Mute Room</button>
<button class="btn btn-danger" onclick="clearHands()">‚úã Clear Hands</button>
</div>
</div>
</div>
</div>
<script>
let u={name:'Thi·ªÅn sinh m·ªõi',x:300,y:200,state:'standing',meditating:false,isHost:true,micOn:false,handRaised:false};
let t={m:0,s:0,i:null};
let users=['üå∏ Minh An','üçÉ Thu H√†','üå∫ ƒê·ª©c Nam','üåø Linh Chi'];
let roomMuted=false;
let raisedHands=[];

function createAvatar(){
const a=document.createElement('div');
a.className=`avatar ${u.state}`;
a.id='myAvatar';
a.style.left=u.x+'px';
a.style.top=u.y+'px';
a.innerHTML=`<div class="s"></div><div class="name host">${u.name} (Host)</div>`;
document.getElementById('garden').appendChild(a);
}

function createNPCs(){
users.forEach((name,i)=>{
const a=document.createElement('div');
const isRaising=Math.random()>.7;
const isSitting=Math.random()>.5;
a.className=`avatar ${isSitting?'sitting meditating':'standing'}`;
a.id=`npc_${i}`;
a.style.left=(180+i*80)+'px';
a.style.top=(160+Math.random()*80)+'px';
a.innerHTML=`<div class="s"></div><div class="name">${name}</div>`;
if(isRaising){
a.classList.add('raising-hand');
raisedHands.push(name);
}
document.getElementById('garden').appendChild(a);
});
updateRaisedHandsList();
}

function changeState(state){
u.state=state;
const a=document.getElementById('myAvatar');
a.className=`avatar ${state}`;
if(u.meditating)a.classList.add('meditating');
if(u.micOn)a.classList.add('speaking');
if(u.handRaised)a.classList.add('raising-hand');
document.querySelectorAll('.btn-group .btn').forEach(b=>b.classList.remove('active'));
event.target.classList.remove('active');
addMessage('system',`${u.name} ƒë√£ ${state==='sitting'?'ng·ªìi thi·ªÅn':'ƒë·ª©ng d·∫≠y'}`);
}

function toggleMeditate(){
u.meditating=!u.meditating;
const b=document.getElementById('meditateBtn');
const a=document.getElementById('myAvatar');
if(u.meditating){
b.textContent='D·ª´ng thi·ªÅn';
b.classList.add('active');
a.classList.add('meditating');
addMessage('system',`${u.name} b·∫Øt ƒë·∫ßu thi·ªÅn üßò‚Äç‚ôÄÔ∏è`);
}else{
b.textContent='B·∫Øt ƒë·∫ßu thi·ªÅn';
b.classList.remove('active');
a.classList.remove('meditating');
addMessage('system',`${u.name} k·∫øt th√∫c thi·ªÅn`);
}
}

function toggleMic(){
if(roomMuted&&!u.isHost){
addMessage('system','‚ùå Ph√≤ng ƒëang b·ªã mute. H√£y gi∆° tay ƒë·ªÉ xin ph√°t bi·ªÉu.');
return;
}
u.micOn=!u.micOn;
const btn=document.getElementById('micBtn');
const avatar=document.getElementById('myAvatar');
const status=document.getElementById('voiceStatus');
if(u.micOn){
btn.classList.add('active');
avatar.classList.add('speaking');
status.textContent='üé§ ƒêang n√≥i...';
addMessage('system',`üé§ ${u.name} b·∫Øt ƒë·∫ßu n√≥i`);
}else{
btn.classList.remove('active');
avatar.classList.remove('speaking');
status.textContent=roomMuted?'üîá Ph√≤ng ƒëang mute':'üé§ Voice Chat: ƒêang m·ªü';
addMessage('system',`üé§ ${u.name} d·ª´ng n√≥i`);
}
}

function toggleHand(){
u.handRaised=!u.handRaised;
const btn=document.getElementById('handBtn');
const avatar=document.getElementById('myAvatar');
if(u.handRaised){
btn.classList.add('active');
avatar.classList.add('raising-hand');
raisedHands.push(u.name);
addMessage('system',`‚úã ${u.name} gi∆° tay xin ph√°t bi·ªÉu`);
}else{
btn.classList.remove('active');
avatar.classList.remove('raising-hand');
raisedHands=raisedHands.filter(name=>name!==u.name);
addMessage('system',`‚úã ${u.name} h·∫° tay`);
}
updateRaisedHandsList();
}

function toggleMuteRoom(){
if(!u.isHost)return;
roomMuted=!roomMuted;
const btn=document.getElementById('muteRoomBtn');
const status=document.getElementById('roomStatus');
const voiceStatus=document.getElementById('voiceStatus');
if(roomMuted){
btn.textContent='üîä Unmute Room';
btn.classList.remove('btn-warning');
btn.classList.add('btn-danger');
status.textContent='üîá Ph√≤ng ƒëang mute';
status.classList.add('muted');
voiceStatus.textContent='üîá Ph√≤ng ƒëang mute';
addMessage('system','üîá Ch·ªß ph√≤ng ƒë√£ mute to√†n b·ªô. Gi∆° tay ƒë·ªÉ xin ph√°t bi·ªÉu.');
}else{
btn.textContent='üîá Mute Room';
btn.classList.remove('btn-danger');
btn.classList.add('btn-warning');
status.textContent='üîä Ph√≤ng ƒëang m·ªü';
status.classList.remove('muted');
voiceStatus.textContent='üé§ Voice Chat: ƒêang m·ªü';
addMessage('system','üîä Ch·ªß ph√≤ng ƒë√£ unmute ph√≤ng. M·ªçi ng∆∞·ªùi c√≥ th·ªÉ n√≥i t·ª± do.');
}
}

function clearHands(){
if(!u.isHost)return;
raisedHands=[];
document.querySelectorAll('.avatar').forEach(a=>a.classList.remove('raising-hand'));
if(u.handRaised){
u.handRaised=false;
document.getElementById('handBtn').classList.remove('active');
}
updateRaisedHandsList();
addMessage('system','‚úã Ch·ªß ph√≤ng ƒë√£ clear t·∫•t c·∫£ raised hands');
}

function updateRaisedHandsList(){
const count=raisedHands.length;
if(count>0){
addMessage('system',`‚úã ƒêang gi∆° tay (${count}): ${raisedHands.join(', ')}`);
}
}

function startTimer(){
if(!t.i){
t.i=setInterval(()=>{
t.s++;
if(t.s>=60){t.m++;t.s=0}
document.getElementById('timer').textContent=String(t.m).padStart(2,'0')+':'+String(t.s).padStart(2,'0');
},1000);
addMessage('system','‚è∞ B·∫Øt ƒë·∫ßu ƒë·ªìng h·ªì thi·ªÅn');
}
}

function resetTimer(){
if(t.i)clearInterval(t.i);
t.i=null;t.m=0;t.s=0;
document.getElementById('timer').textContent='00:00';
addMessage('system','‚è∞ ƒê√£ reset ƒë·ªìng h·ªì');
}

function sendMessage(){
const input=document.getElementById('messageInput');
const msg=input.value.trim();
if(msg){
addMessage(u.name,msg,true);
input.value='';
setTimeout(()=>{
const responses=['C·∫£m ∆°n b·∫°n üôè','Th·∫≠t y√™n b√¨nh','T√¥i c≈©ng th∆∞ gi√£n','H√£y c√πng tƒ©nh t√¢m','Host ∆°i cho em n√≥i v·ªõi','Em mu·ªën chia s·∫ª c·∫£m x√∫c'];
const randomUser=users[Math.floor(Math.random()*users.length)];
const randomResponse=responses[Math.floor(Math.random()*responses.length)];
addMessage(randomUser,randomResponse);
},1000+Math.random()*2000);
}
}

function addMessage(author,text,isOwn){
const m=document.getElementById('messages');
const d=document.createElement('div');
const msgType=author==='system'?'system':isOwn?'own':'other';
d.className=`message ${msgType}`;
if(msgType==='system'){
d.innerHTML=text;
}else{
d.innerHTML=`<div style="font-size:9px;opacity:.7;margin-bottom:2px">${author}</div><div>${text}</div>`;
}
m.appendChild(d);
m.scrollTop=m.scrollHeight;
if(m.children.length>40)m.removeChild(m.firstChild);
}

document.getElementById('garden').addEventListener('click',e=>{
if(e.target.id==='garden'||e.target.classList.contains('garden')){
u.x=Math.max(10,Math.min(e.clientX-24,window.innerWidth-320));
u.y=Math.max(10,Math.min(e.clientY-32,window.innerHeight-80));
const a=document.getElementById('myAvatar');
a.style.left=u.x+'px';
a.style.top=u.y+'px';
a.classList.add('walking');
setTimeout(()=>a.classList.remove('walking'),800);
}
});

document.getElementById('username').addEventListener('input',e=>{
u.name=e.target.value||'Thi·ªÅn sinh m·ªõi';
document.querySelector('#myAvatar .name').textContent=u.name+' (Host)';
});

// Simulate NPC activities
setInterval(()=>{
if(Math.random()<.15){
const npc=users[Math.floor(Math.random()*users.length)];
if(Math.random()<.3){
// Random hand raising
const avatar=document.getElementById(`npc_${users.indexOf(npc)}`);
if(avatar&&!avatar.classList.contains('raising-hand')){
avatar.classList.add('raising-hand');
raisedHands.push(npc);
addMessage('system',`‚úã ${npc} gi∆° tay xin ph√°t bi·ªÉu`);
updateRaisedHandsList();
}
}else{
// Random messages
const msgs=['Host ∆°i cho em n√≥i','Em mu·ªën chia s·∫ª','V∆∞·ªùn n√†y y√™n b√¨nh','Em c·∫ßn xin ph√°t bi·ªÉu'];
const randomMsg=msgs[Math.floor(Math.random()*msgs.length)];
addMessage(npc,randomMsg);
}
}
},20000+Math.random()*25000);

// Auto lower hands after time  
setInterval(()=>{
if(Math.random()<.2&&raisedHands.length>0){
const randomHand=raisedHands[Math.floor(Math.random()*raisedHands.length)];
if(randomHand!==u.name){
const npcIndex=users.indexOf(randomHand);
if(npcIndex>=0){
const avatar=document.getElementById(`npc_${npcIndex}`);
if(avatar)avatar.classList.remove('raising-hand');
}
raisedHands=raisedHands.filter(name=>name!==randomHand);
addMessage('system',`‚úã ${randomHand} ƒë√£ h·∫° tay`);
}
}
},30000);

createAvatar();
createNPCs();
console.log('üå∏ V∆∞·ªùn Thi·ªÅn v·ªõi Voice Management s·∫µn s√†ng!');
</script>
</body>
</html>
